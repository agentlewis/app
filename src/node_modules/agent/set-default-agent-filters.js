var Url = require('url')
var config = require('config')
var prefix = Url.format(config.api)
var member = prefix + '/roleTypes/member'
var subgroup = prefix + '/roleTypes/subgroup'
var debug = require('debug')('set-default-filters')

module.exports = function (filter, agentId, hasChildren) {
  if (filter.targetAgent['@type'] === 'Group' && filter.agentType) {
    if (hasChildren && filter.id === 'Group-' + subgroup) {
      //[Groups that are part of] [Group] + [part of]
      filter.agentType.active = true
      filter.roleType.active = true
      filter.linkType.active = true
      filter.targetAgent.active = true
    }
    else if (!hasChildren && filter.id === 'Person-' + member) {
      //[People who belong to] [Group]
      filter.agentType.active = true
      filter.roleType.active = true
      filter.targetAgent.active = true
    }
  }
  else if (!filter.contextAgentId && filter.targetAgent['@type'] === 'Person') {
    filter.agentType.active = true
    filter.roleType.active = true
    filter.targetAgent.active = true
    if (filter.targetAgent.id == agentId) filter.linkType.active = true
  }
  debug('filter', filter)
  return filter
}
