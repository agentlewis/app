var Model = require('base/model');
var debug = require('debug')("craftodex:ui:agent:model");

var Relationships = require('relationship/collection');

module.exports = Model.extend({

  modelType: "Agent",

  initialize: function () {
    this.on("change", debug);
  },

  props: {
    name: "string",
  },

  children: {
    relationships: Relationships,
  },

  derived: {
    relationshipsByType: {
      deps: ['relationships'],
      cache: false,
      fn: function () {
        var rels = {};
        this.relationships.forEach(function (rel) {
          var relType = rel.relationshipType;
          if (!relType) return;
          var relType = relType.name;
          if (!rels[relType]) {
            rels[relType] = new Relationships();
          }
          rels[relType].add(rel);
        });
        return rels;
      },
    },
  },

});
