var Agent = require('agent/model')
var store = require('base/store')
var roles = require('role/store')
var relationships = require('relationship/store')
var debug = require('debug')('src:group:model')
var Url = require('url')
var config = require('config')
var prefix = Url.format(config.api)
console.log('PREFIX', prefix)

module.exports = Agent.extend({
  typeName: 'Group',
  collectionName: 'groups',

  derived: {
    memberships: {
      cache: true,
      fn: function () {
        return roles.data.filter(function (role) {
          return (role.type === prefix + "/roleTypes/member" && role.agent === this['@id'])
        }.bind(this))
      }
    },

    // parentGroups: {
    //   cache: false,
    //   fn: function () {
    //     var id = this.getId()
    //     return store.findById(id)
    //   }
    // },
  }
})
