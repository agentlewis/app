var Url = require('url')
var defaults = require('lodash.defaultsdeep')
<<<<<<< HEAD
var clone = require('lodash.clone')
var defined = require('defined')
=======
>>>>>>> better way to services

var isProd = require('util/isProd')
var config = require('../../../node_modules/config')

config.services.forEach(function (serviceName) {
<<<<<<< HEAD
  config[serviceName] = defined(config[serviceName], {})
  defaults(config[serviceName], { url: clone(config.url) })
=======
  defaults(config[serviceName], { url: config.url })
>>>>>>> better way to services

  // HACK because of dokku:
  // unset config ports for production server
  if (isProd) {
<<<<<<< HEAD
    delete config[serviceName].url.port
=======
    config[serviceName].url.port = undefined
>>>>>>> better way to services
  }
})

module.exports = config
