var levelup = require('levelup')
var Token = require('google-oauth-jwt-stream').Token
var RowDown = require('sheet-down').RowDOWN
var through = require('through2')

var config = require('config')

getSheet(config.data)
.createReadStream()
.pipe(print())

function getSheet (opts) {
  var token = new Token(opts.email, opts.key, opts.scopes)
  return levelup(opts.location, new RowDown({ token: token}))
}

function print (opts) {
  return through.obj(function (row, enc, cb) {
    console.log(row)
    cb()
  })
}
