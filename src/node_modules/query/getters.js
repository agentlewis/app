'use strict';
import { createSelector } from 'reselect'
import { agentRelsByRelation } from 'relationship/getters'
import { indexBy, foreach, values } from 'lodash'

// WIP
export const agentQueries = (agentId) => {
  return createSelector(
    [agentRelsByRelation(agentId)],
    agentRelsByRelation => {
      let queries = []
      let relations = ['source', 'target', 'context']
      for (relation of relations) {
        let relTypesMap = {}
        foreach(agentRelsByRelation[relation], relationship => {
          if (!relTypesMap[relationship.type]) {
            let query = { relationshipType: relationship.type }
            query[relation] = agentId
            queries.push(query)
            relTypesMap[relationship.type] = true
          }
        })
      }

      return queries
    }
  )
}

export const getQueriesById = state => { 
  return  state.queriesById
}

export const getQueries = createSelector(
  [getQueriesById],
  queriesById => values(queriesById)
)

