var ObservNodeArray = require('observ-node-array')
var forEach = require('for-each')

module.exports = function ObservGraph (opts) {

  // default options
  opts.Types = opts.Types || {}
  opts.typeAttribute = opts.typeAttribute || 'type'

  // TODO provide get by id observ to relations

  var graph = ObservNodeArray({
    nodes: opts.types,
    nodeKey: opts.typeAttribute,
  })

  forEach(opts.types, function (Type, typeId) {
    Type.context(graph)
  })

  return graph
}
