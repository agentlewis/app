var fs = require('fs')
var Path = require('path')
var less = require('less-middleware')

var isDev = require('util/isDev')

module.exports = lessService

function lessService (config) {
  //
  // serve less styles
  //
  return less('/', {
    debug: isDev,
    pathRoot: Path.join(__dirname, '..'),
    dest: 'assets',
    once: !isDev,
    parser: {
      relativeUrls: true,
      paths: fs.readdirSync(Path.join(__dirname))
        .concat([
          Path.join(__dirname, '..', '../node_modules/bootstrap/less')
        ])
    }
  })
}
