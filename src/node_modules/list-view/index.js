var React = require('react')
var Bootstrap = require('react-bootstrap')
var r = require('r-dom')
var map = require('lodash.map')
var debug = require('debug')('holodex:ui:list-view')

var Link = require('base/views/link')
var store = require('base/store')
var router = require('router')

var style = require('./style')

module.exports = React.createClass({

  render: function () {
        
    var agent = this.props.model;

    debug('agent', agent)

    var content = map(agent.relsByType, function (rels, relTypeId) {

      var relType = store.findById(relTypeId)

      debug('relType', relType.toJSON(), "rels", rels.map(function (rel) { return rel.toJSON() }))

      return (
        r.section({
          className: "relationships"
        }, [
          r.header(relType.pluralName + ':'),
          r(Bootstrap.ListGroup, {
            className: relType.pluralName
          }, rels.map(function (rel) {
            debug("rel", rel.toJSON())

            return (
              r(Bootstrap.ListGroupItem, {
                className: relType.name,
                key: rel.getId(),
                style: style.listItem,
              }, rel.labelOf(agent))
            )
          }))
        ])
      )
    })

    return r.div({}, content)
  },
})
