var Observ = require('observ')
var ObservComputed = require('observ/computed')

var isUrl = require('util/is-url')
var prefixUrl = require('util/prefix-url')
var Url = require('url')

module.exports = ObservId

function ObservId (value, options) {
  
  var obs = Observ(value)

  var computed = ObservComputed([obs], function (val) {
    if (!isUrl(val)) {
      return Url.format(
        prefixUrl(
          options.prefix,
          val
        )
      )
    }
    return val
  })

  var obsId = function observId (listener) {
    return computed(listener)
  }

  obsId.set = obs.set

  return obsId
}
