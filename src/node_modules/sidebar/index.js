var insertCss = require('insert-css')
var r = require('r-dom')
var React = require('react')
var fs = require('fs')
var IconFactory = require('react-icon-factory')
var debug = require('debug')('sidebar:index')
var AmpersandReactMixin = require('ampersand-react-mixin')

var Icon = IconFactory({
  'chevron-right': r.g([
    r.path(
      { d: "M10 6l-1.41 1.41 4.58 4.59-4.58 4.59 1.41 1.41 6-6z" }
    )
    ]
  ),
  'chevron-left': r.g([
    r.path(
      { d: "M15.41 7.41l-1.41-1.41-6 6 6 6 1.41-1.41-4.58-4.59z" }
    )
    ]
  )
})

var simpleSidebarCSS = fs.readFileSync(__dirname + '/sidebar.css')
insertCss(simpleSidebarCSS)

module.exports = React.createClass({

  mixins: [AmpersandReactMixin],

  render: function () {
    var self = this
    var isOpen = self.props.isOpen
    var toggle = self.props.toggle
    var iconType = isOpen ? 'chevron-left' : 'chevron-right'
    var model = self.props.model

    debug('model', model.getId(), model.get('name'), model.name )

    return r.div(
      { id: 'sidebar-wrapper' },
      [
        r(Icon, { icon: 'chevron-right', onClick: toggle }),
        r.ul( { className: 'sidebar-nav'}, [
          r.li({ className: 'sidebar-brand'}, [
            r.a({ href: '#'}, model.get('name'))
          ]),
          //NOTE assumes children are wrapped in <li>'s
          //may need a React.children utilities
          self.props.children
        ])
      ]
    )
  }
})
