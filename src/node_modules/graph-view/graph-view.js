// takes node and edge data and out node and edge svgs
//
var React = require('react')
var Url = require('url')
var r = require('r-dom')
var map = require('lodash.map')
var debug = require('debug')('holodex:graph-view')
var keys = require('lodash.keys')
var reduce = require('lodash.reduce')

var Tag = require('./tag')
var IconFactory = require('react-icon-factory')
var TagGroup = require('./tag-group')
var Graph = require('./graph')

var config = require('config')
var prefix = Url.format(config.api)

var style = {
  index: {
    position: 'relative'
  },
  tagControl: {
    position: 'absolute',
    zIndex: 1
  },
  graphContainer: {
    position: 'absolute',
    left: '30%'

  }
}

var getTagData = require('./get-tag-data')

module.exports = React.createClass({
  render: function () {
    var cancelIcon = r(
      this.props.Icon,
      { className: 'cancel-tag', icon: 'clear', onClick: null }
    )

    return (
    r.div({
        className: 'graph-view ',
        style: style.index
      }, [
        r.div({ className: 'tag-control', style: style.tagControl }, [
          r.div({ className: 'tag-group' }, [
            r(TagGroup, {
              style: this.props.style, //top-level
              tagData: this.props.tagData,
              updateTag: this.props.updateTag,
              model: this.props.model,
              cancelIcon: cancelIcon,
              Icon: this.props.Icon
            })
          ])
        ]),
        r.div({ className: 'graph-container', style: style.graphContainer }, [
          r(Graph, {
            //TODO replace with this.props?
            model: this.props.model,
            actions: this.props.actions,
            Icon: this.props.Icon,
            tagData: this.props.tagData
          })
        ])
      ])
    )
  },

  componentWillReceiveProps: function (nextProps) {
    debug('componentWillReceiveProps', {nextProps: nextProps, state: this.state})
  },

  componentWillUpdate: function (nextProps, nextState) {
    debug('componentWillUpdate', {nextProps: nextProps, nextState: nextState})
  },

})
