var store = require('base/store')
var LabelMap = require('./label-map')

module.exports = function (model) {
  var triples = []
  var contextTags = []
  model.filtersByType.agent.forEach(function (filter) {
    if (!filter.agent.active) return
    var agent = store.findById(filter.agentId)
    var triple = []
    var agentFragment = {
      id: filter.id
      filter: filter,
      type:  'Agent',
      label: agent.name
    }
    if (filter.roleType.active) { //[Stewards of] [Mikey]
      var roleTypeFragment = {
        id: filter.id
        filter: filter,
        type: 'roleType',
        label: LabelMap.agent[filter.agentType.id].withLink
      }
      var agentIndex = filter.roletType.id].index === 1 ? 0 : 1
      triple[LabelMap.agent[filter.roletType.id].index] = roleTypeFragment
      triple[agentIndex] = agentFragment
    }
    if (filter.linkType.active) { //[People who] [steward] [Mikey]
      var agentTypeFragment = {
        id: filter.id
        filter: filter,
        type: 'agentType',
        label: LabelMap.agent[filter.agentType.id].withLink
      }
      var linkTypeFragment = {
        id: filter.id
        filter: filter,
        type: 'linkType',
        label: LabelMap.agent[filter.linkType.id].label
      }
      triple[LabelMap.agent[filter.agentType.id].index] = agentTypeFragment
      triple[LabelMap.agent[filter.linkType.id].index] = linkTypeFragment
      triple[LabelMap.agent['Agent'].index] = agentFragment
    }
  })
}
