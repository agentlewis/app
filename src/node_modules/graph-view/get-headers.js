var store = require('base/store')
var Labels = require('./labels')
var debug = require('debug')('graph-view:get-headers')
var format = require('string-format')
var vars = require('ui/vars')
format.extend(String.prototype)

module.exports = function (targetAgentFilters) {
  var targetActive = false
  var agentTypeActive = {}
  var headers = [[]]
  debug('agentFilters', targetAgentFilters)
  targetAgentFilters.forEach(function (filter) {
    // if (filter.targetAgent.active) {
    if (filter.targetAgent.active && !targetActive) {
      var header = []
      var agent = store.findById(filter.targetAgent.id)
      var agentTag = {
        filter: filter,
        type:  'Agent',
        label: agent.name
      }
      headers[0].push(agentTag)
      targetActive = true
    }
    if (filter.agentType.active && !agentTypeActive[filter.agentType.id]) {
      debug('filter', filter)
      var agentTypeTag = {
        filter: filter,
        type:  'AgentType',
        label: Labels[filter.agentType.id]
      }
      debug('headers', headers)
      if (headers[headers.length-1].length > 2) headers.push([])
      headers[headers.length-1].push(agentTypeTag)
      agentTypeActive[filter.agentType.id] = true
    }
      // if (filter.roleType.active) {
      //   debug('filter', filter)
      //   var roleTag = {
      //     filter: filter,
      //     type:  'Role',
      //     label: Labels.targetAgent[filter.roleType.id].template.format(filter.targetAgent.name)
      //   }
      //   debug('headers', headers)
      //   if (headers[headers.length-1].length > 2) headers.push([])
      //   headers[headers.length-1].push(roleTag)

      // if (filter.agentType.active) {
      //   debug('filter', filter)
      //   var relationTag = {
      //     filter: filter,
      //     label: Labels.targetAgent[filter.roleType.id].label,
      //     // label: Labels.targetAgent[filter.roleType.id].template.format(Labels[filter.agentType.id]),
      //     type: 'Relation'
      //   }
      //   header[Labels.targetAgent[filter.roleType.id].index] = relationTag
      // }
      //
      // var agentIndex = header[0] ? 1 : 0 //does relatonTag exist?
      // header[agentIndex] = agentTag
    // }
  })
  debug('headers', headers)
  return headers
}
