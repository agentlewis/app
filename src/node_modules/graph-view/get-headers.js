var store = require('base/store')
var Labels = require('./labels')
var debug = require('debug')('graph-view:get-headers')
var format = require('string-format')
format.extend(String.prototype)

module.exports = function (targetAgentFilters) {
  // if (!targetAgentFilters) return
  var headers = []
  debug('agentFilters', targetAgentFilters)
  targetAgentFilters.forEach(function (filter) {
    if (filter.targetAgent.active) {
      var header = []
      var agent = store.findById(filter.targetAgent.id)
      var agentTag = {
        filter: filter,
        type:  'Agent',
        label: agent.name
      }

      if (filter.agentType.active) {
        var relationTag = {
          filter: filter,
          label: Labels.targetAgent[filter.roleType.id].template.format(Labels[filter.agentType.id]),
          type: 'Relation'
        }
        header[Labels.targetAgent[filter.roleType.id].index] = relationTag
      }

      var agentIndex = header[0] ? 1 : 0 //does relatonTag exist?
      header[agentIndex] = agentTag
      headers.push(header)
    }
  })
  debug('headers', headers)
  return headers
}
