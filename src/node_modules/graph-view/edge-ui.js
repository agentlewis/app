var React = require('react');
var debug = require('debug')('edge-ui');


function pythagoras (a, b) {
	return Math.sqrt((a*a)+(b*b))
}

module.exports = React.createClass({

	render: function () {
		var d = this.props.datum;
		var r = this.props.radius || 28;

                if (!(
                  d.target.x && d.source.x &&
                  d.target.y && d.source.y
                )) {
                  return null;
                }

		var a = d.target.x - d.source.x;
		var b = d.target.y - d.source.y;

                debug("a, b", a, b);

		var c = pythagoras(a,b);
		var t = c ? ((c-r) / c) : c;

                debug("c, t", c, t);

		var x = (t*a)+d.source.x;
		var y = (t*b)+d.source.y;

		debug({ d: d, x: x, y:y })

		return React.createElement("line", 
			{
				x1: d.source.x,
				x2: x,
				y1: d.source.y,
				y2: y,
				stroke: 'grey',
				markerEnd: "url(#arrowhead)"
			}
		);
	}
}) 
