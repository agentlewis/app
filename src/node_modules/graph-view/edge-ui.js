var React = require('react')
var debug = require('debug')('edge-ui')

// TODO use vector math
function pythagoras (a, b) {
  return Math.sqrt((a * a) + (b * b))
}

module.exports = React.createClass({
  render: function () {
    var d = this.props.edge
    var r = this.props.radius || 28

    if (!(
      d.target.x && d.source.x &&
      d.target.y && d.source.y
      )) {
      return null
    }

    var a = d.target.x - d.source.x
    var b = d.target.y - d.source.y

    var c = pythagoras(a, b)
    var t = c ? ((c - r) / c) : c

    var x = (t * a) + d.source.x
    var y = (t * b) + d.source.y

    var markerEnd = d.hidden ? null : 'url(#arrowhead)'


    return React.createElement('line', {
      x1: d.source.x,
      x2: x,
      y1: d.source.y,
      y2: y,
      stroke: d.color,
      strokeWidth: 2,   
      markerEnd: markerEnd,
      display: d.hidden ? 'none' : 'inherit'
    })
  }
})
