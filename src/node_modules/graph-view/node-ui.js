var React     = require('react')
var extend    = require('xtend')
var debug     = require('debug')("holodex:ui:graph-view:node-ui")


var router    = require('router')

// TODO dynamic styles
var style = {
  circleClip20: {
    'border': "2px solid white",
    'borderRadius': 20,
    '-mozBorderRadius': 20,
    '-webkitBorderRadius': 20,
    'boxShadow': "0px 0px 5px rgba(48,48,48,0.9)",
    '-webkitBoxShadow': "0px 0px 5px rgba(48,48,48,0.9)",
    '-webkit-clip-path': 'circle(50% at 50% 50%)',
    'clip-path': 'circle(50% at 50% 50%)'
  },

  node: {
    position: 'absolute',
  }
}

module.exports = React.createClass({

  propTypes: {
    datum: React.PropTypes.object.isRequired
  },

  render: function () {
    var d = this.props.datum

    var w = 40
    var h = 40
    var offset = w / 2

    var x = d.x - offset
    var y = d.y - offset

    return (
      React.createElement('image', {
        'xlink:href': d.image,
        height: String(h),
        width: String(w),
        x: String(x),
        y: String(y),
        clipPath: 'url(#circle-clip-20)',
        className: 'node circle-clip-20',
        style: style.circleClip20,
        onClick: this.handleClick
      })
    )
  },

  getHref: function () {
    return router.format({ id: this.props.datum.id })
  },

  navigate: router.navigate.bind(router),

  handleClick: function () {
    this.navigate(this.getHref())    
  }
})
