var r = require('r-dom')
var React = require('react')
var debug = require('debug')('tag-select')
var keys = require('lodash.keys')
var each = require('lodash.foreach')
var Typeahead = require('simple-react-typeahead')

module.exports = React.createClass({
  propTypes: {
    style: React.PropTypes.object,
    options: React.PropTypes.array,
    updateTag: React.PropTypes.func.isRequired
  },

  // getInitialState: function () {
  //   //TODO idToTypeMap
  //   var state = this.processTagData(this.props.tagData)
  //   return state
  // },

  // componentWillReceiveProps: function (nextProps) {
  //   var state = this.processTagData(nextProps.tagData)
  //   this.setState(state)
  // },

  render: function () {
    return r.div({ className: 'tag-select' }, [
      r(Typeahead, {
          id: 'test',
          style: this.props.style,
          array: this.props.options,
          placeholder: 'Select filters',
          onSelect: this.handleSelect
        }
      )
    ])
  },

  handleSelect: function (id) {
    var type = this.state.idToTypeMap[id]
    this.props.updateTag(type, id, true)()
  }
})
