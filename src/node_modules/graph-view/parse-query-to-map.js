var dot = require('dot-object')
var debug = require('debug')('parse-query-to-map')

module.exports = function (query) {
  var options = []
  var q = query.q || []

  var querymap = q.reduce(function (memo, q) {
    //not used
    // if (q.role) {
    //   if (q.ctx) { memo[q.role +'.ctx.'+ q.ctx] = q }
    // }

    if (q.link) {
      debug('query has link', q.link)
      if (q.tgt) {
        memo[q.link + '.tgt.' + q.tgt] = q
      }
      if (q.src) {
        memo[q.link + '.src.' + q.src] = q
      }
      if (q.ctx) {
        memo[q.link +'.ctx.'+ q.ctx] = q
      }
    }


    return memo
  }, {})

  return querymap

}
