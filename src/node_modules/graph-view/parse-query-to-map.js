var debug = require('debug')('parse-query-to-map')

module.exports = function (query) {
  var q = query.q || []
  return q.reduce(function (memo, q) {
    if (q.link) {
      debug('query has link', q.link)
      if (q.tgt) {
        memo[q.link + '.tgt.' + q.tgt] = q
      }
      if (q.src) {
        memo[q.link + '.src.' + q.src] = q
      }
      if (q.ctx) {
        memo[q.link + '.ctx.' + q.ctx] = q
      }
    }

    return memo
  }, {})
}
