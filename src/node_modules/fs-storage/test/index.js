var test = require('tape');

var Storage, storage; 

test("require module", function (t) {
  Storage = require('../');
  t.ok(Storage, "FsStorage is required");
  t.ok(Storage.prototype, "FsStorage has prototype");
  t.end();
});

test("construct storage", function (t) {
  storage = new Storage({
    fsRoot: __dirname + "/data",
    collection: "people",
    collections: {
      people: {
        id: "Person",
      },
    },
  });
  t.ok(storage, "fsStorage is constructed");
  t.end();
});

test("get alice person", function (t) {
  storage.get("alice", {}, function (err, alice) {
    t.error(err, "no error");
    t.deepEqual(alice, {
      "@id": "alice",
      "@type": "Person",
      "name": "Alice",
    }, "alice is correct");
    t.end();
  });
});

test("find people", function (t) {
  storage.find({}, function (err, people) {
    t.error(err, "no error");
    t.deepEqual(people, [{
      "@id": "alice",
      "@type": "Person",
      name: "Alice",
    }], "people are correct");
    t.end();
  });
});
