var Model = require('base/model')

var roleTypes = require('role-type/store')

module.exports = Model.extend({
  typeName: "RelationshipType",
  collectionName: 'relationshipTypes',

  props: {
    name: "string",
    pluralName: "string",
  },

  initialize: function (attrs, opts) {
    Model.prototype.initialize.apply(this, arguments)

    this._roleTypes = roleTypes
      .addDynamicView(this.getId() + "/roleTypes")
      .applyFind({
        relationshipType: this.getId()
      })
  },

  derived: {
    roleTypes: {
      cache: false,
      fn: function () {
        var store = require('store')
        return this._roleTypes.data()
        .map(function (id) {
          return store.findById(id)
        })
      }
    }
  }
})
